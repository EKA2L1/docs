<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>EKA2L1 Lua API Reference</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>EKA2L1</h1>


<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Brief_purpose_introduction">Brief purpose introduction </a></li>
<li><a href="#Script_location">Script location </a></li>
<li><a href="#Script_lifetime">Script lifetime </a></li>
<li><a href="#Script_reload">Script reload </a></li>
<li><a href="#Script_executor">Script executor </a></li>
</ul>


<h2>Topics</h2>
<ul class="">
  <li><strong>Note about scripting</strong></li>
  <li><a href="../topics/debuggingwithgdb.md.html">Debugging with IDA</a></li>
</ul>
<h2>Modules</h2>
<ul class="nowrap">
  <li><a href="../modules/common.html">common</a></li>
  <li><a href="../modules/cpu.html">cpu</a></li>
  <li><a href="../modules/events.html">events</a></li>
  <li><a href="../modules/ipc.context.html">ipc.context</a></li>
  <li><a href="../modules/kernel.html">kernel</a></li>
  <li><a href="../modules/mem.html">mem</a></li>
  <li><a href="../modules/std.html">std</a></li>
</ul>

</div>

<div id="content">


<h1>Note about scripting</h1>

<p><a name="Brief_purpose_introduction"></a></p>
<h2>Brief purpose introduction</h2>

<p>EKA2L1 provides a <em>Lua scripting API</em> for interacting with the emulator, aiding those who like to write app/game specific patches, reverse-engineering or other analysing tasks without touching the core C++ code of the emulator.</p>

<p>The API itself is very barebone for debugging usages on the emulator. If you are interested in suggesting more features after looking at this document, feel free to contact the developers on <a href="https://discord.gg/5Bm5SJ9">Discord</a>.</p>

<p><a name="Script_location"></a></p>
<h2>Script location</h2>

<p>EKA2L1 loads all scripts in the root <strong>scripts</strong> folder, with resides in the default current directory. The current directory of the emulator for each OS.</p>

<ul>
    <li><p><strong>On Windows:</strong> This is the same folder as where the emulator executable lies.</p></li>
    <li><p><strong>On MacOS:</strong> <code>/Users/&lt;current_user&gt;/Library/Application Support/EKA2L1/</code></p></li>
    <li><p><strong>On Linux:</strong> <code>~/.local/share/EKA2L1/</code></p></li>
</ul>

<p>The scripts are loaded firstly after all the emulated device's initialisations are done.</p>

<p><a name="Script_lifetime"></a></p>
<h2>Script lifetime</h2>

<p>Script will be unloaded on these occassions:</p>

<ul>
    <li><p>On script file modification (delete, move, modify, etc...).</p></li>
    <li><p>On emulator exit.</p></li>
    <li><p>On device reset/choosing another device.</p></li>
</ul>

<p>If you plan on making your script persistent across the run of the emulator, you might need to save your process frequently, or avoid doing time-intensive task.</p>

<p><a name="Script_reload"></a></p>
<h2>Script reload</h2>

<p>EKA2L1 now supports reloading script on the fly. If you modify the script while EKA2L1 is running, the old script will be unloaded in favour of the new one, helping those that want to debug live.</p>

<p>Note that this may come with the risk of crash, if the script is not coded properly. This risk is much smaller when the emulator is idle.</p>

<p><a name="Script_executor"></a></p>
<h2>Script executor</h2>

<p>EKA2L1 makes use of <a href="https://github.com/LuaJIT/LuaJIT"><strong>LuaJIT</strong></a> to execute your scripts, and the scripting part is heavily designed around LuaJIT's FFI feature.</p>

<p>Because of so, your scripts is limited to maximum compability with Lua 5.1, so take that in mind when you write a script.</p>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
<i style="float:right;">Last updated 2021-10-30 01:56:22 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
